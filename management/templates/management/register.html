{% extends 'management/base.html' %}
{% block content %}

<style>
    /* Show Password Badge - Student Style */
    .password-toggle {
        position: absolute;
        right: 15px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        font-weight: 900;
        font-size: 0.65rem;
        background: black;
        color: white;
        padding: 6px 12px;
        border: 2px solid black;
        border-radius: 8px;
        text-transform: uppercase;
        user-select: none;
        transition: 0.2s;
        z-index: 10;
    }

    /* Student Blue Glow Effect  */
    .valid-glow-blue {
        border-color: var(--sync-blue) !important;
        box-shadow: 0 0 15px var(--sync-blue);
    }
</style>

<div style="display: flex; justify-content: center; align-items: center; min-height: 90vh; padding: 40px 20px;">
    <div class="brutalist-card" style="width: 100%; max-width: 500px; border-color: var(--sync-blue); background: white;">
        
        <div style="text-align: center; margin-bottom: 45px;">
            <div style="background: var(--sync-neon); color: black; display: inline-block; padding: 10px 25px; border: 4px solid black; transform: rotate(-2deg); font-weight: 950; font-size: 1.2rem; box-shadow: 6px 6px 0px black;">
                STUDENT_AUTH_INIT
            </div>
            <h1 style="font-size: 3.5rem; font-weight: 950; letter-spacing: -3px; margin-top: 25px; text-transform: uppercase; color: black; line-height: 0.9;">
                CREATE<br>IDENTITY
            </h1>
        </div>

        <form method="POST">
            {% csrf_token %}
            
            {% for field in form %}
            <div style="margin-bottom: 25px;">
                <label class="industrial-label" style="background: var(--sync-blue); color: white; margin-bottom: 10px; border: 2px solid black;">
                    {{ field.label_tag|striptags }}
                </label>
                
                <div style="position: relative;">
                    <input type="{{ field.field.widget.input_type }}" 
                           name="{{ field.name }}" 
                           id="id_{{ field.name }}"
                           required
                           {% if "password" in field.name.lower %}oninput="checkStudentStrength(this)"{% endif %}
                           style="width: 100%; border: 4px solid black; padding: 18px; border-radius: 15px; font-weight: 800; font-size: 1rem; box-sizing: border-box; background: #f8fafc; color: black; transition: 0.3s;">
                    
                    {% if "password" in field.name.lower %}
                        <span class="password-toggle" onclick="toggleStudentPassword('id_{{ field.name }}', this)">Show</span>
                    {% endif %}
                </div>

                {% if field.help_text %}
                    <p style="font-size: 0.65rem; font-weight: 800; color: #94a3b8; margin-top: 8px; text-transform: uppercase;">
                        {{ field.help_text }}
                    </p>
                {% endif %}
            </div>
            {% endfor %}

            <button type="submit" class="sync-btn" style="width: 100%; padding: 22px; font-size: 1.3rem; background: var(--sync-blue); color: white; border: 4px solid black; box-shadow: 0px 8px 0px black;">
                INITIALIZE IDENTITY SYNC
            </button>
        </form>
    </div>
</div>

<script>
    // Validation: Add Blue Glow if password is 8+ characters
    function checkStudentStrength(input) {
        if (input.value.length >= 8) {
            input.classList.add('valid-glow-blue');
        } else {
            input.classList.remove('valid-glow-blue');
        }
    }

    function toggleStudentPassword(fieldId, btn) {
        const field = document.getElementById(fieldId);
        if (field.type === 'password') {
            field.type = 'text';
            btn.innerText = 'Hide';
            btn.style.background = 'var(--sync-blue)';
        } else {
            field.type = 'password';
            btn.innerText = 'Show';
            btn.style.background = 'black';
        }
    }
</script>

{% endblock %}